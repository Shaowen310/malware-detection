import csv
import numpy as np
import pandas as pd
import re

def read_data_file(data_file_path):
    with open(data_file_path, 'rU') as f:
        data = list(list(map(lambda x: int(x)+1, row)) for row in csv.reader(f, delimiter=','))

    return data


def read_label_file(label_file_path):
    df = pd.read_csv(label_file_path, sep=',', header=0, usecols=['category'])
    return df.values

def split_train_data(data_file_path, dest_path, length):
    wf = open(dest_path, 'w')
    with open(data_file_path, 'rU') as f:
        index = 0
        for row in f.readlines():
            if (index <=length):
                wf.write(row)
                index+=1
    wf.close()

def read_ununified_data(data_file_path):
    x = []
    with open(data_file_path, 'rU') as f:
        for row in f.read().splitlines():
            x.append(re.sub(',',' ', row ))
    x = np.asarray(x)

    return x
